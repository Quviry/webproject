var t={};Object.defineProperty(t,"__esModule",{value:true});t.default=void 0;var r="1.7.0";var o=r;t.default=o;var i={};Object.defineProperty(i,"__esModule",{value:true});i.getPositionName=i.getPosition=i.Position=i.Node=void 0;function _createForOfIteratorHelper$6(t,r){var o="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=_unsupportedIterableToArray$6(t))||r&&t&&"number"===typeof t.length){o&&(t=o);var i=0;var a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:true}:{done:false,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,u=true,d=false;return{s:function s(){o=o.call(t)},n:function n(){var t=o.next();u=t.done;return t},e:function e(t){d=true;l=t},f:function f(){try{u||null==o.return||o.return()}finally{if(d)throw l}}}}function _unsupportedIterableToArray$6(t,r){if(t){if("string"===typeof t)return _arrayLikeToArray$6(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);return"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray$6(t,r):void 0}}function _arrayLikeToArray$6(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _classCallCheck$b(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties$b(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,_toPropertyKey$b(i.key),i)}}function _createClass$b(t,r,o){r&&_defineProperties$b(t.prototype,r);o&&_defineProperties$b(t,o);Object.defineProperty(t,"prototype",{writable:false});return t}function _defineProperty$b(t,r,o){r=_toPropertyKey$b(r);r in t?Object.defineProperty(t,r,{value:o,enumerable:true,configurable:true,writable:true}):t[r]=o;return t}function _toPropertyKey$b(t){var r=_toPrimitive$b(t,"string");return"symbol"===_typeof$b(r)?r:String(r)}function _toPrimitive$b(t,r){if("object"!==_typeof$b(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==_typeof$b(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}function _typeof$b(t){return _typeof$b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$b(t)}var a;i.Position=a;(function(t){t[t.Before=1]="Before";t[t.After=2]="After";t[t.Inside=3]="Inside";t[t.None=4]="None"})(a||(i.Position=a={}));var l={before:a.Before,after:a.After,inside:a.Inside,none:a.None};var u=function getPositionName(t){for(var r in l)if(Object.prototype.hasOwnProperty.call(l,r)&&l[r]===t)return r;return""};i.getPositionName=u;var d=function getPosition(t){return l[t]};i.getPosition=d;var c=function isNodeRecordWithChildren(t){return"object"===_typeof$b(t)&&"children"in t&&t.children instanceof Array};var h=function(){function Node(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Node;_classCallCheck$b(this,Node);_defineProperty$b(this,"id",void 0);_defineProperty$b(this,"name",void 0);_defineProperty$b(this,"children",void 0);_defineProperty$b(this,"parent",void 0);_defineProperty$b(this,"idMapping",void 0);_defineProperty$b(this,"tree",void 0);_defineProperty$b(this,"nodeClass",void 0);_defineProperty$b(this,"load_on_demand",void 0);_defineProperty$b(this,"is_open",void 0);_defineProperty$b(this,"element",void 0);_defineProperty$b(this,"is_loading",void 0);_defineProperty$b(this,"isEmptyFolder",void 0);this.name="";this.isEmptyFolder=false;this.load_on_demand=false;this.setData(t);this.children=[];this.parent=null;if(r){this.idMapping=new Map;this.tree=this;this.nodeClass=o}}_createClass$b(Node,[{key:"setData",value:function setData(t){if(t)if("string"===typeof t)this.name=t;else if("object"===_typeof$b(t))for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var o=t[r];"label"===r||"name"===r?"string"===typeof o&&(this.name=o):"children"!==r&&"parent"!==r&&(this[r]=o)}}},{key:"loadFromData",value:function loadFromData(t){this.removeChildren();var r,o=_createForOfIteratorHelper$6(t);try{for(o.s();!(r=o.n()).done;){var i=r.value;var a=this.createNode(i);this.addChild(a);c(i)&&(0===i.children.length?a.isEmptyFolder=true:a.loadFromData(i.children))}}catch(t){o.e(t)}finally{o.f()}return this}},{key:"addChild",value:function addChild(t){this.children.push(t);t.setParent(this)}},{key:"addChildAtPosition",value:function addChildAtPosition(t,r){this.children.splice(r,0,t);t.setParent(this)}},{key:"removeChild",value:function removeChild(t){t.removeChildren();this.doRemoveChild(t)}},{key:"getChildIndex",value:function getChildIndex(t){return this.children.indexOf(t)}},{key:"hasChildren",value:function hasChildren(){return 0!==this.children.length}},{key:"isFolder",value:function isFolder(){return this.hasChildren()||this.load_on_demand}},{key:"iterate",value:function iterate(t){var r=function _iterate(r,o){if(r.children){var i,a=_createForOfIteratorHelper$6(r.children);try{for(a.s();!(i=a.n()).done;){var l=i.value;var u=t(l,o);u&&l.hasChildren()&&_iterate(l,o+1)}}catch(t){a.e(t)}finally{a.f()}}};r(this,0)}},{key:"moveNode",value:function moveNode(t,r,o){if(!t.parent||t.isParentOf(r))return false;t.parent.doRemoveChild(t);switch(o){case a.After:if(r.parent){r.parent.addChildAtPosition(t,r.parent.getChildIndex(r)+1);return true}return false;case a.Before:if(r.parent){r.parent.addChildAtPosition(t,r.parent.getChildIndex(r));return true}return false;case a.Inside:r.addChildAtPosition(t,0);return true;default:return false}}},{key:"getData",value:function getData(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var r=function getDataFromNodes(t){return t.map((function(t){var r={};for(var o in t)if(-1===["parent","children","element","idMapping","load_on_demand","nodeClass","tree","isEmptyFolder"].indexOf(o)&&Object.prototype.hasOwnProperty.call(t,o)){var i=t[o];r[o]=i}t.hasChildren()&&(r.children=getDataFromNodes(t.children));return r}))};return r(t?[this]:this.children)}},{key:"getNodeByName",value:function getNodeByName(t){return this.getNodeByCallback((function(r){return r.name===t}))}},{key:"getNodeByNameMustExist",value:function getNodeByNameMustExist(t){var r=this.getNodeByCallback((function(r){return r.name===t}));if(!r)throw"Node with name ".concat(t," not found");return r}},{key:"getNodeByCallback",value:function getNodeByCallback(t){var r=null;this.iterate((function(o){if(r)return false;if(t(o)){r=o;return false}return true}));return r}},{key:"addAfter",value:function addAfter(t){if(this.parent){var r=this.createNode(t);var o=this.parent.getChildIndex(this);this.parent.addChildAtPosition(r,o+1);c(t)&&t.children.length&&r.loadFromData(t.children);return r}return null}},{key:"addBefore",value:function addBefore(t){if(this.parent){var r=this.createNode(t);var o=this.parent.getChildIndex(this);this.parent.addChildAtPosition(r,o);c(t)&&t.children.length&&r.loadFromData(t.children);return r}return null}},{key:"addParent",value:function addParent(t){if(this.parent){var r=this.createNode(t);this.tree&&r.setParent(this.tree);var o=this.parent;var i,a=_createForOfIteratorHelper$6(o.children);try{for(a.s();!(i=a.n()).done;){var l=i.value;r.addChild(l)}}catch(t){a.e(t)}finally{a.f()}o.children=[];o.addChild(r);return r}return null}},{key:"remove",value:function remove(){if(this.parent){this.parent.removeChild(this);this.parent=null}}},{key:"append",value:function append(t){var r=this.createNode(t);this.addChild(r);c(t)&&t.children.length&&r.loadFromData(t.children);return r}},{key:"prepend",value:function prepend(t){var r=this.createNode(t);this.addChildAtPosition(r,0);c(t)&&t.children.length&&r.loadFromData(t.children);return r}},{key:"isParentOf",value:function isParentOf(t){var r=t.parent;while(r){if(r===this)return true;r=r.parent}return false}},{key:"getLevel",value:function getLevel(){var t=0;var r=this;while(r.parent){t+=1;r=r.parent}return t}},{key:"getNodeById",value:function getNodeById(t){return this.idMapping.get(t)||null}},{key:"addNodeToIndex",value:function addNodeToIndex(t){null!=t.id&&this.idMapping.set(t.id,t)}},{key:"removeNodeFromIndex",value:function removeNodeFromIndex(t){null!=t.id&&this.idMapping.delete(t.id)}},{key:"removeChildren",value:function removeChildren(){var t=this;this.iterate((function(r){var o;null===(o=t.tree)||void 0===o?void 0:o.removeNodeFromIndex(r);return true}));this.children=[]}},{key:"getPreviousSibling",value:function getPreviousSibling(){if(this.parent){var t=this.parent.getChildIndex(this)-1;return t>=0?this.parent.children[t]:null}return null}},{key:"getNextSibling",value:function getNextSibling(){if(this.parent){var t=this.parent.getChildIndex(this)+1;return t<this.parent.children.length?this.parent.children[t]:null}return null}},{key:"getNodesByProperty",value:function getNodesByProperty(t,r){return this.filter((function(o){return o[t]===r}))}},{key:"filter",value:function filter(t){var r=[];this.iterate((function(o){t(o)&&r.push(o);return true}));return r}},{key:"getNextNode",value:function getNextNode(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(t&&this.hasChildren())return this.children[0];if(this.parent){var r=this.getNextSibling();return r||this.parent.getNextNode(false)}return null}},{key:"getNextVisibleNode",value:function getNextVisibleNode(){if(this.hasChildren()&&this.is_open)return this.children[0];if(this.parent){var t=this.getNextSibling();return t||this.parent.getNextNode(false)}return null}},{key:"getPreviousNode",value:function getPreviousNode(){if(this.parent){var t=this.getPreviousSibling();return t?t.hasChildren()?t.getLastChild():t:this.getParent()}return null}},{key:"getPreviousVisibleNode",value:function getPreviousVisibleNode(){if(this.parent){var t=this.getPreviousSibling();return t?t.hasChildren()&&t.is_open?t.getLastChild():t:this.getParent()}return null}},{key:"getParent",value:function getParent(){return this.parent&&this.parent.parent?this.parent:null}},{key:"getLastChild",value:function getLastChild(){if(this.hasChildren()){var t=this.children[this.children.length-1];return t.hasChildren()&&t.is_open?t.getLastChild():t}return null}},{key:"initFromData",value:function initFromData(t){var r=this;var o=function addNode(t){r.setData(t);c(t)&&t.children.length&&i(t.children)};var i=function addChildren(t){var o,i=_createForOfIteratorHelper$6(t);try{for(i.s();!(o=i.n()).done;){var a=o.value;var l=r.createNode();l.initFromData(a);r.addChild(l)}}catch(t){i.e(t)}finally{i.f()}};o(t)}},{key:"setParent",value:function setParent(t){var r;this.parent=t;this.tree=t.tree;null===(r=this.tree)||void 0===r?void 0:r.addNodeToIndex(this)}},{key:"doRemoveChild",value:function doRemoveChild(t){var r;this.children.splice(this.getChildIndex(t),1);null===(r=this.tree)||void 0===r?void 0:r.removeNodeFromIndex(t)}},{key:"getNodeClass",value:function getNodeClass(){var t;return this.nodeClass||(null===this||void 0===this||null===(t=this.tree)||void 0===t?void 0:t.nodeClass)||Node}},{key:"createNode",value:function createNode(t){var r=this.getNodeClass();return new r(t)}}]);return Node}();i.Node=h;var p={};Object.defineProperty(p,"__esModule",{value:true});p.HitAreasGenerator=p.DragAndDropHandler=void 0;var v=i;function _typeof$a(t){return _typeof$a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$a(t)}function _createForOfIteratorHelper$5(t,r){var o="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=_unsupportedIterableToArray$5(t))||r&&t&&"number"===typeof t.length){o&&(t=o);var i=0;var a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:true}:{done:false,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,u=true,d=false;return{s:function s(){o=o.call(t)},n:function n(){var t=o.next();u=t.done;return t},e:function e(t){d=true;l=t},f:function f(){try{u||null==o.return||o.return()}finally{if(d)throw l}}}}function _unsupportedIterableToArray$5(t,r){if(t){if("string"===typeof t)return _arrayLikeToArray$5(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);return"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray$5(t,r):void 0}}function _arrayLikeToArray$5(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _inherits$3(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:true,configurable:true}});Object.defineProperty(t,"prototype",{writable:false});r&&_setPrototypeOf$3(t,r)}function _setPrototypeOf$3(t,r){_setPrototypeOf$3=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(t,r){t.__proto__=r;return t};return _setPrototypeOf$3(t,r)}function _createSuper$3(t){var r=_isNativeReflectConstruct$3();return function _createSuperInternal(){var o,i=_getPrototypeOf$3(t);if(r){var a=_getPrototypeOf$3(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn$3(this,o)}}function _possibleConstructorReturn$3(t,r){if(r&&("object"===_typeof$a(r)||"function"===typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$3(t)}function _assertThisInitialized$3(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct$3(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return true}catch(t){return false}}function _getPrototypeOf$3(t){_getPrototypeOf$3=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)};return _getPrototypeOf$3(t)}function _classCallCheck$a(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties$a(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,_toPropertyKey$a(i.key),i)}}function _createClass$a(t,r,o){r&&_defineProperties$a(t.prototype,r);o&&_defineProperties$a(t,o);Object.defineProperty(t,"prototype",{writable:false});return t}function _defineProperty$a(t,r,o){r=_toPropertyKey$a(r);r in t?Object.defineProperty(t,r,{value:o,enumerable:true,configurable:true,writable:true}):t[r]=o;return t}function _toPropertyKey$a(t){var r=_toPrimitive$a(t,"string");return"symbol"===_typeof$a(r)?r:String(r)}function _toPrimitive$a(t,r){if("object"!==_typeof$a(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==_typeof$a(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var y=function(){function DragAndDropHandler(t){_classCallCheck$a(this,DragAndDropHandler);_defineProperty$a(this,"hitAreas",void 0);_defineProperty$a(this,"isDragging",void 0);_defineProperty$a(this,"currentItem",void 0);_defineProperty$a(this,"hoveredArea",void 0);_defineProperty$a(this,"positionInfo",void 0);_defineProperty$a(this,"treeWidget",void 0);_defineProperty$a(this,"dragElement",void 0);_defineProperty$a(this,"previousGhost",void 0);_defineProperty$a(this,"openFolderTimer",void 0);this.treeWidget=t;this.hoveredArea=null;this.hitAreas=[];this.isDragging=false;this.currentItem=null;this.positionInfo=null}_createClass$a(DragAndDropHandler,[{key:"mouseCapture",value:function mouseCapture(t){var r=jQuery(t.target);if(!this.mustCaptureElement(r))return null;if(this.treeWidget.options.onIsMoveHandle&&!this.treeWidget.options.onIsMoveHandle(r))return null;var o=this.treeWidget._getNodeElement(r);o&&this.treeWidget.options.onCanMove&&(this.treeWidget.options.onCanMove(o.node)||(o=null));this.currentItem=o;return null!=this.currentItem}},{key:"mouseStart",value:function mouseStart(t){var r;if(!this.currentItem||void 0===t.pageX||void 0===t.pageY)return false;this.refresh();var o=jQuery(t.target).offset();var i=o?o.left:0;var a=o?o.top:0;var l=this.currentItem.node;this.dragElement=new _(l.name,t.pageX-i,t.pageY-a,this.treeWidget.element,null===(r=this.treeWidget.options.autoEscape)||void 0===r||r);this.isDragging=true;this.positionInfo=t;this.currentItem.$element.addClass("jqtree-moving");return true}},{key:"mouseDrag",value:function mouseDrag(t){if(!this.currentItem||!this.dragElement||void 0===t.pageX||void 0===t.pageY)return false;this.dragElement.move(t.pageX,t.pageY);this.positionInfo=t;var r=this.findHoveredArea(t.pageX,t.pageY);if(r&&this.canMoveToArea(r)){r.node.isFolder()||this.stopOpenFolderTimer();if(this.hoveredArea!==r){this.hoveredArea=r;this.mustOpenFolderTimer(r)?this.startOpenFolderTimer(r.node):this.stopOpenFolderTimer();this.updateDropHint()}}else{this.removeDropHint();this.stopOpenFolderTimer();this.hoveredArea=r}r||this.treeWidget.options.onDragMove&&this.treeWidget.options.onDragMove(this.currentItem.node,t.originalEvent);return true}},{key:"mouseStop",value:function mouseStop(t){this.moveItem(t);this.clear();this.removeHover();this.removeDropHint();this.removeHitAreas();var r=this.currentItem;if(this.currentItem){this.currentItem.$element.removeClass("jqtree-moving");this.currentItem=null}this.isDragging=false;this.positionInfo=null;!this.hoveredArea&&r&&this.treeWidget.options.onDragStop&&this.treeWidget.options.onDragStop(r.node,t.originalEvent);return false}},{key:"refresh",value:function refresh(){this.removeHitAreas();if(this.currentItem){this.generateHitAreas();this.currentItem=this.treeWidget._getNodeElementForNode(this.currentItem.node);this.isDragging&&this.currentItem.$element.addClass("jqtree-moving")}}},{key:"generateHitAreas",value:function generateHitAreas(){if(this.currentItem){var t=new g(this.treeWidget.tree,this.currentItem.node,this.getTreeDimensions().bottom);this.hitAreas=t.generate()}else this.hitAreas=[]}},{key:"mustCaptureElement",value:function mustCaptureElement(t){return!t.is("input,select,textarea")}},{key:"canMoveToArea",value:function canMoveToArea(t){if(!this.treeWidget.options.onCanMoveTo)return true;if(!this.currentItem)return false;var r=(0,v.getPositionName)(t.position);return this.treeWidget.options.onCanMoveTo(this.currentItem.node,t.node,r)}},{key:"removeHitAreas",value:function removeHitAreas(){this.hitAreas=[]}},{key:"clear",value:function clear(){if(this.dragElement){this.dragElement.remove();this.dragElement=null}}},{key:"removeDropHint",value:function removeDropHint(){this.previousGhost&&this.previousGhost.remove()}},{key:"removeHover",value:function removeHover(){this.hoveredArea=null}},{key:"findHoveredArea",value:function findHoveredArea(t,r){var o=this.getTreeDimensions();if(t<o.left||r<o.top||t>o.right||r>o.bottom)return null;var i=0;var a=this.hitAreas.length;while(i<a){var l=i+a>>1;var u=this.hitAreas[l];if(r<u.top)a=l;else{if(!(r>u.bottom))return u;i=l+1}}return null}},{key:"mustOpenFolderTimer",value:function mustOpenFolderTimer(t){var r=t.node;return r.isFolder()&&!r.is_open&&t.position===v.Position.Inside}},{key:"updateDropHint",value:function updateDropHint(){if(this.hoveredArea){this.removeDropHint();var t=this.treeWidget._getNodeElementForNode(this.hoveredArea.node);this.previousGhost=t.addDropHint(this.hoveredArea.position)}}},{key:"startOpenFolderTimer",value:function startOpenFolderTimer(t){var r=this;var o=function openFolder(){r.treeWidget._openNode(t,r.treeWidget.options.slide,(function(){r.refresh();r.updateDropHint()}))};this.stopOpenFolderTimer();var i=this.treeWidget.options.openFolderDelay;false!==i&&(this.openFolderTimer=window.setTimeout(o,i))}},{key:"stopOpenFolderTimer",value:function stopOpenFolderTimer(){if(this.openFolderTimer){clearTimeout(this.openFolderTimer);this.openFolderTimer=null}}},{key:"moveItem",value:function moveItem(t){var r=this;if(this.currentItem&&this.hoveredArea&&this.hoveredArea.position!==v.Position.None&&this.canMoveToArea(this.hoveredArea)){var o=this.currentItem.node;var i=this.hoveredArea.node;var a=this.hoveredArea.position;var l=o.parent;a===v.Position.Inside&&(this.hoveredArea.node.is_open=true);var u=function doMove(){r.treeWidget.tree.moveNode(o,i,a);r.treeWidget.element.empty();r.treeWidget._refreshElements(null)};var d=this.treeWidget._triggerEvent("tree.move",{move_info:{moved_node:o,target_node:i,position:(0,v.getPositionName)(a),previous_parent:l,do_move:u,original_event:t.originalEvent}});d.isDefaultPrevented()||u()}}},{key:"getTreeDimensions",value:function getTreeDimensions(){var t=this.treeWidget.element.offset();if(t){var r=this.treeWidget.element;var o=r.width()||0;var i=r.height()||0;var a=t.left+this.treeWidget._getScrollLeft();return{left:a,top:t.top,right:a+o,bottom:t.top+i+16}}return{left:0,top:0,right:0,bottom:0}}}]);return DragAndDropHandler}();p.DragAndDropHandler=y;var m=function(){function VisibleNodeIterator(t){_classCallCheck$a(this,VisibleNodeIterator);_defineProperty$a(this,"tree",void 0);this.tree=t}_createClass$a(VisibleNodeIterator,[{key:"iterate",value:function iterate(){var t=this;var r=true;var o=function _iterateNode(o,i){var a=(o.is_open||!o.element)&&o.hasChildren();var l=null;if(o.element){l=jQuery(o.element);if(!l.is(":visible"))return;if(r){t.handleFirstNode(o);r=false}o.hasChildren()?o.is_open?t.handleOpenFolder(o,l)||(a=false):t.handleClosedFolder(o,i,l):t.handleNode(o,i,l)}if(a){var u=o.children.length;o.children.forEach((function(t,r){_iterateNode(o.children[r],r===u-1?null:o.children[r+1])}));o.is_open&&l&&t.handleAfterOpenFolder(o,i)}};o(this.tree,null)}}]);return VisibleNodeIterator}();var g=function(t){_inherits$3(HitAreasGenerator,t);var r=_createSuper$3(HitAreasGenerator);function HitAreasGenerator(t,o,i){var a;_classCallCheck$a(this,HitAreasGenerator);a=r.call(this,t);_defineProperty$a(_assertThisInitialized$3(a),"currentNode",void 0);_defineProperty$a(_assertThisInitialized$3(a),"treeBottom",void 0);_defineProperty$a(_assertThisInitialized$3(a),"positions",void 0);_defineProperty$a(_assertThisInitialized$3(a),"lastTop",void 0);a.currentNode=o;a.treeBottom=i;return a}_createClass$a(HitAreasGenerator,[{key:"generate",value:function generate(){this.positions=[];this.lastTop=0;this.iterate();return this.generateHitAreas(this.positions)}},{key:"generateHitAreas",value:function generateHitAreas(t){var r=-1;var o=[];var i=[];var a,l=_createForOfIteratorHelper$5(t);try{for(l.s();!(a=l.n()).done;){var u=a.value;if(u.top!==r&&o.length){o.length&&this.generateHitAreasForGroup(i,o,r,u.top);r=u.top;o=[]}o.push(u)}}catch(t){l.e(t)}finally{l.f()}this.generateHitAreasForGroup(i,o,r,this.treeBottom);return i}},{key:"handleOpenFolder",value:function handleOpenFolder(t,r){if(t===this.currentNode)return false;t.children[0]!==this.currentNode&&this.addPosition(t,v.Position.Inside,this.getTop(r));return true}},{key:"handleClosedFolder",value:function handleClosedFolder(t,r,o){var i=this.getTop(o);if(t===this.currentNode)this.addPosition(t,v.Position.None,i);else{this.addPosition(t,v.Position.Inside,i);r!==this.currentNode&&this.addPosition(t,v.Position.After,i)}}},{key:"handleFirstNode",value:function handleFirstNode(t){t!==this.currentNode&&this.addPosition(t,v.Position.Before,this.getTop(jQuery(t.element)))}},{key:"handleAfterOpenFolder",value:function handleAfterOpenFolder(t,r){t===this.currentNode||r===this.currentNode?this.addPosition(t,v.Position.None,this.lastTop):this.addPosition(t,v.Position.After,this.lastTop)}},{key:"handleNode",value:function handleNode(t,r,o){var i=this.getTop(o);t===this.currentNode?this.addPosition(t,v.Position.None,i):this.addPosition(t,v.Position.Inside,i);r===this.currentNode||t===this.currentNode?this.addPosition(t,v.Position.None,i):this.addPosition(t,v.Position.After,i)}},{key:"getTop",value:function getTop(t){var r=t.offset();return r?r.top:0}},{key:"addPosition",value:function addPosition(t,r,o){var i={top:o,bottom:0,node:t,position:r};this.positions.push(i);this.lastTop=o}},{key:"generateHitAreasForGroup",value:function generateHitAreasForGroup(t,r,o,i){var a=Math.min(r.length,4);var l=Math.round((i-o)/a);var u=o;var d=0;while(d<a){var c=r[d];t.push({top:u,bottom:u+l,node:c.node,position:c.position});u+=l;d+=1}}}]);return HitAreasGenerator}(m);p.HitAreasGenerator=g;var _=function(){function DragElement(t,r,o,i,a){_classCallCheck$a(this,DragElement);_defineProperty$a(this,"offsetX",void 0);_defineProperty$a(this,"offsetY",void 0);_defineProperty$a(this,"$element",void 0);this.offsetX=r;this.offsetY=o;this.$element=jQuery("<span>").addClass("jqtree-title jqtree-dragging");a?this.$element.text(t):this.$element.html(t);this.$element.css("position","absolute");i.append(this.$element)}_createClass$a(DragElement,[{key:"move",value:function move(t,r){this.$element.offset({left:t-this.offsetX,top:r-this.offsetY})}},{key:"remove",value:function remove(){this.$element.remove()}}]);return DragElement}();var b={};Object.defineProperty(b,"__esModule",{value:true});b.isInt=b.isFunction=b.getBoolString=void 0;var P=function isInt(t){return"number"===typeof t&&t%1===0};b.isInt=P;var $=function isFunction(t){return"function"===typeof t};b.isFunction=$;var S=function getBoolString(t){return t?"true":"false"};b.getBoolString=S;var N={};Object.defineProperty(N,"__esModule",{value:true});N.default=void 0;var k=b;function _typeof$9(t){return _typeof$9="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$9(t)}function _createForOfIteratorHelper$4(t,r){var o="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=_unsupportedIterableToArray$4(t))||r&&t&&"number"===typeof t.length){o&&(t=o);var i=0;var a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:true}:{done:false,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,u=true,d=false;return{s:function s(){o=o.call(t)},n:function n(){var t=o.next();u=t.done;return t},e:function e(t){d=true;l=t},f:function f(){try{u||null==o.return||o.return()}finally{if(d)throw l}}}}function _unsupportedIterableToArray$4(t,r){if(t){if("string"===typeof t)return _arrayLikeToArray$4(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);return"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray$4(t,r):void 0}}function _arrayLikeToArray$4(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _classCallCheck$9(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties$9(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,_toPropertyKey$9(i.key),i)}}function _createClass$9(t,r,o){r&&_defineProperties$9(t.prototype,r);o&&_defineProperties$9(t,o);Object.defineProperty(t,"prototype",{writable:false});return t}function _defineProperty$9(t,r,o){r=_toPropertyKey$9(r);r in t?Object.defineProperty(t,r,{value:o,enumerable:true,configurable:true,writable:true}):t[r]=o;return t}function _toPropertyKey$9(t){var r=_toPrimitive$9(t,"string");return"symbol"===_typeof$9(r)?r:String(r)}function _toPrimitive$9(t,r){if("object"!==_typeof$9(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==_typeof$9(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var O=function(){function ElementsRenderer(t){_classCallCheck$9(this,ElementsRenderer);_defineProperty$9(this,"openedIconElement",void 0);_defineProperty$9(this,"closedIconElement",void 0);_defineProperty$9(this,"treeWidget",void 0);this.treeWidget=t;this.openedIconElement=this.createButtonElement(t.options.openedIcon||"+");this.closedIconElement=this.createButtonElement(t.options.closedIcon||"-")}_createClass$9(ElementsRenderer,[{key:"render",value:function render(t){t&&t.parent?this.renderFromNode(t):this.renderFromRoot()}},{key:"renderFromRoot",value:function renderFromRoot(){var t=this.treeWidget.element;t.empty();this.createDomElements(t[0],this.treeWidget.tree.children,true,1)}},{key:"renderFromNode",value:function renderFromNode(t){var r=jQuery(t.element);var o=this.createLi(t,t.getLevel());this.attachNodeData(t,o);r.after(o);r.remove();t.children&&this.createDomElements(o,t.children,false,t.getLevel()+1)}},{key:"createDomElements",value:function createDomElements(t,r,o,i){var a=this.createUl(o);t.appendChild(a);var l,u=_createForOfIteratorHelper$4(r);try{for(u.s();!(l=u.n()).done;){var d=l.value;var c=this.createLi(d,i);a.appendChild(c);this.attachNodeData(d,c);d.hasChildren()&&this.createDomElements(c,d.children,false,i+1)}}catch(t){u.e(t)}finally{u.f()}}},{key:"attachNodeData",value:function attachNodeData(t,r){t.element=r;jQuery(r).data("node",t)}},{key:"createUl",value:function createUl(t){var r;var o;if(t){r="jqtree-tree";o="tree";this.treeWidget.options.rtl&&(r+=" jqtree-rtl")}else{r="";o="group"}this.treeWidget.options.dragAndDrop&&(r+=" jqtree-dnd");var i=document.createElement("ul");i.className="jqtree_common ".concat(r);i.setAttribute("role",o);return i}},{key:"createLi",value:function createLi(t,r){var o=Boolean(this.treeWidget.selectNodeHandler.isNodeSelected(t));var i=t.isFolder()||t.isEmptyFolder&&this.treeWidget.options.showEmptyFolder;var a=i?this.createFolderLi(t,r,o):this.createNodeLi(t,r,o);this.treeWidget.options.onCreateLi&&this.treeWidget.options.onCreateLi(t,jQuery(a),o);return a}},{key:"createFolderLi",value:function createFolderLi(t,r,o){var i=this.getButtonClasses(t);var a=this.getFolderClasses(t,o);var l=t.is_open?this.openedIconElement:this.closedIconElement;var u=document.createElement("li");u.className="jqtree_common ".concat(a);u.setAttribute("role","presentation");var d=document.createElement("div");d.className="jqtree-element jqtree_common";d.setAttribute("role","presentation");u.appendChild(d);var c=document.createElement("a");c.className=i;c.appendChild(l.cloneNode(true));c.setAttribute("role","presentation");c.setAttribute("aria-hidden","true");this.treeWidget.options.buttonLeft&&d.appendChild(c);d.appendChild(this.createTitleSpan(t.name,r,o,t.is_open,true));this.treeWidget.options.buttonLeft||d.appendChild(c);return u}},{key:"createNodeLi",value:function createNodeLi(t,r,o){var i=["jqtree_common"];o&&i.push("jqtree-selected");var a=i.join(" ");var l=document.createElement("li");l.className=a;l.setAttribute("role","presentation");var u=document.createElement("div");u.className="jqtree-element jqtree_common";u.setAttribute("role","presentation");l.appendChild(u);u.appendChild(this.createTitleSpan(t.name,r,o,t.is_open,false));return l}},{key:"createTitleSpan",value:function createTitleSpan(t,r,o,i,a){var l=document.createElement("span");var u="jqtree-title jqtree_common";a&&(u+=" jqtree-title-folder");u+=" jqtree-title-button-".concat(this.treeWidget.options.buttonLeft?"left":"right");l.className=u;l.setAttribute("role","treeitem");l.setAttribute("aria-level","".concat(r));l.setAttribute("aria-selected",(0,k.getBoolString)(o));l.setAttribute("aria-expanded",(0,k.getBoolString)(i));if(o){var d=this.treeWidget.options.tabIndex;void 0!==d&&l.setAttribute("tabindex","".concat(d))}this.treeWidget.options.autoEscape?l.textContent=t:l.innerHTML=t;return l}},{key:"getButtonClasses",value:function getButtonClasses(t){var r=["jqtree-toggler","jqtree_common"];t.is_open||r.push("jqtree-closed");this.treeWidget.options.buttonLeft?r.push("jqtree-toggler-left"):r.push("jqtree-toggler-right");return r.join(" ")}},{key:"getFolderClasses",value:function getFolderClasses(t,r){var o=["jqtree-folder"];t.is_open||o.push("jqtree-closed");r&&o.push("jqtree-selected");t.is_loading&&o.push("jqtree-loading");return o.join(" ")}},{key:"createButtonElement",value:function createButtonElement(t){if("string"===typeof t){var r=document.createElement("div");r.innerHTML=t;return document.createTextNode(r.innerHTML)}return jQuery(t)[0]}}]);return ElementsRenderer}();N.default=O;var w={};Object.defineProperty(w,"__esModule",{value:true});w.default=void 0;function _typeof$8(t){return _typeof$8="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$8(t)}function ownKeys$2(t,r){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),o.push.apply(o,i)}return o}function _objectSpread$2(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?ownKeys$2(Object(o),!0).forEach((function(r){_defineProperty$8(t,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):ownKeys$2(Object(o)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(o,r))}))}return t}function _classCallCheck$8(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties$8(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,_toPropertyKey$8(i.key),i)}}function _createClass$8(t,r,o){r&&_defineProperties$8(t.prototype,r);o&&_defineProperties$8(t,o);Object.defineProperty(t,"prototype",{writable:false});return t}function _defineProperty$8(t,r,o){r=_toPropertyKey$8(r);r in t?Object.defineProperty(t,r,{value:o,enumerable:true,configurable:true,writable:true}):t[r]=o;return t}function _toPropertyKey$8(t){var r=_toPrimitive$8(t,"string");return"symbol"===_typeof$8(r)?r:String(r)}function _toPrimitive$8(t,r){if("object"!==_typeof$8(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==_typeof$8(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var j=function(){function DataLoader(t){_classCallCheck$8(this,DataLoader);_defineProperty$8(this,"treeWidget",void 0);this.treeWidget=t}_createClass$8(DataLoader,[{key:"loadFromUrl",value:function loadFromUrl(t,r,o){var i=this;if(t){var a=this.getDomElement(r);this.addLoadingClass(a);this.notifyLoading(true,r,a);var l=function stopLoading(){i.removeLoadingClass(a);i.notifyLoading(false,r,a)};var u=function handleSuccess(t){l();i.treeWidget.loadData(i.parseData(t),r);o&&"function"===typeof o&&o()};var d=function handleError(t){l();i.treeWidget.options.onLoadFailed&&i.treeWidget.options.onLoadFailed(t)};this.submitRequest(t,u,d)}}},{key:"addLoadingClass",value:function addLoadingClass(t){t&&t.addClass("jqtree-loading")}},{key:"removeLoadingClass",value:function removeLoadingClass(t){t&&t.removeClass("jqtree-loading")}},{key:"getDomElement",value:function getDomElement(t){return t?jQuery(t.element):this.treeWidget.element}},{key:"notifyLoading",value:function notifyLoading(t,r,o){this.treeWidget.options.onLoading&&this.treeWidget.options.onLoading(t,r,o);this.treeWidget._triggerEvent("tree.loading_data",{isLoading:t,node:r,$el:o})}},{key:"submitRequest",value:function submitRequest(t,r,o){var i;var a="string"===typeof t?{url:t}:t;var l=_objectSpread$2({method:"GET",cache:false,dataType:"json",success:r,error:o},a);l.method=(null===(i=l.method)||void 0===i?void 0:i.toUpperCase())||"GET";void jQuery.ajax(l)}},{key:"parseData",value:function parseData(t){var r=this.treeWidget.options.dataFilter;var o=function getParsedData(){return"string"===typeof t?JSON.parse(t):t};var i=o();return r?r(i):i}}]);return DataLoader}();w.default=j;var C={};Object.defineProperty(C,"__esModule",{value:true});C.default=void 0;function _typeof$7(t){return _typeof$7="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$7(t)}function _classCallCheck$7(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties$7(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,_toPropertyKey$7(i.key),i)}}function _createClass$7(t,r,o){r&&_defineProperties$7(t.prototype,r);o&&_defineProperties$7(t,o);Object.defineProperty(t,"prototype",{writable:false});return t}function _defineProperty$7(t,r,o){r=_toPropertyKey$7(r);r in t?Object.defineProperty(t,r,{value:o,enumerable:true,configurable:true,writable:true}):t[r]=o;return t}function _toPropertyKey$7(t){var r=_toPrimitive$7(t,"string");return"symbol"===_typeof$7(r)?r:String(r)}function _toPrimitive$7(t,r){if("object"!==_typeof$7(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==_typeof$7(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var I=function(){function KeyHandler(t){var r=this;_classCallCheck$7(this,KeyHandler);_defineProperty$7(this,"treeWidget",void 0);_defineProperty$7(this,"handleKeyDown",(function(t){if(!r.canHandleKeyboard())return true;var o=r.treeWidget.getSelectedNode();if(!o)return true;var i=t.which;switch(i){case KeyHandler.DOWN:return r.moveDown(o);case KeyHandler.UP:return r.moveUp(o);case KeyHandler.RIGHT:return r.moveRight(o);case KeyHandler.LEFT:return r.moveLeft(o);default:return true}}));this.treeWidget=t;t.options.keyboardSupport&&jQuery(document).on("keydown.jqtree",this.handleKeyDown)}_createClass$7(KeyHandler,[{key:"deinit",value:function deinit(){jQuery(document).off("keydown.jqtree")}},{key:"moveDown",value:function moveDown(t){return this.selectNode(t.getNextVisibleNode())}},{key:"moveUp",value:function moveUp(t){return this.selectNode(t.getPreviousVisibleNode())}},{key:"moveRight",value:function moveRight(t){if(t.isFolder()){if(t.is_open)return this.selectNode(t.getNextVisibleNode());this.treeWidget.openNode(t);return false}return true}},{key:"moveLeft",value:function moveLeft(t){if(t.isFolder()&&t.is_open){this.treeWidget.closeNode(t);return false}return this.selectNode(t.getParent())}},{key:"selectNode",value:function selectNode(t){if(t){this.treeWidget.selectNode(t);this.treeWidget.scrollHandler.isScrolledIntoView(jQuery(t.element).find(".jqtree-element"))||this.treeWidget.scrollToNode(t);return false}return true}},{key:"canHandleKeyboard",value:function canHandleKeyboard(){return!!this.treeWidget.options.keyboardSupport&&this.treeWidget.selectNodeHandler.isFocusOnTree()}}]);return KeyHandler}();C.default=I;_defineProperty$7(I,"LEFT",37);_defineProperty$7(I,"UP",38);_defineProperty$7(I,"RIGHT",39);_defineProperty$7(I,"DOWN",40);var D={};Object.defineProperty(D,"__esModule",{value:true});D.default=void 0;function ownKeys$1(t,r){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),o.push.apply(o,i)}return o}function _objectSpread$1(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?ownKeys$1(Object(o),!0).forEach((function(r){_defineProperty$6(t,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):ownKeys$1(Object(o)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(o,r))}))}return t}function _classCallCheck$6(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties$6(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,_toPropertyKey$6(i.key),i)}}function _createClass$6(t,r,o){r&&_defineProperties$6(t.prototype,r);o&&_defineProperties$6(t,o);Object.defineProperty(t,"prototype",{writable:false});return t}function _defineProperty$6(t,r,o){r=_toPropertyKey$6(r);r in t?Object.defineProperty(t,r,{value:o,enumerable:true,configurable:true,writable:true}):t[r]=o;return t}function _toPropertyKey$6(t){var r=_toPrimitive$6(t,"string");return"symbol"===_typeof$6(r)?r:String(r)}function _toPrimitive$6(t,r){if("object"!==_typeof$6(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==_typeof$6(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}function _typeof$6(t){return _typeof$6="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$6(t)}function _createForOfIteratorHelper$3(t,r){var o="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=_unsupportedIterableToArray$3(t))||r&&t&&"number"===typeof t.length){o&&(t=o);var i=0;var a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:true}:{done:false,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,u=true,d=false;return{s:function s(){o=o.call(t)},n:function n(){var t=o.next();u=t.done;return t},e:function e(t){d=true;l=t},f:function f(){try{u||null==o.return||o.return()}finally{if(d)throw l}}}}function _unsupportedIterableToArray$3(t,r){if(t){if("string"===typeof t)return _arrayLikeToArray$3(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);return"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray$3(t,r):void 0}}function _arrayLikeToArray$3(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}var T=function register(t,r){var o=function getDataKey(){return"simple_widget_".concat(r)};var i=function getWidgetData(t,r){var o=jQuery.data(t,r);return o&&o instanceof E?o:null};var a=function createWidget(r,a){var l=o();var u,d=_createForOfIteratorHelper$3(r.get());try{for(d.s();!(u=d.n()).done;){var c=u.value;var h=i(c,l);if(!h){var p=t;var v=new p(c,a);jQuery.data(c,l)||jQuery.data(c,l,v);v.init()}}}catch(t){d.e(t)}finally{d.f()}return r};var l=function destroyWidget(t){var r=o();var a,l=_createForOfIteratorHelper$3(t.get());try{for(l.s();!(a=l.n()).done;){var u=a.value;var d=i(u,r);d&&d.destroy();jQuery.removeData(u,r)}}catch(t){l.e(t)}finally{l.f()}};var u=function callFunction(t,r,i){var a=null;var l,u=_createForOfIteratorHelper$3(t.get());try{for(u.s();!(l=u.n()).done;){var d=l.value;var c=jQuery.data(d,o());if(c&&c instanceof E){var h=c;var p=h[r];p&&"function"===typeof p&&(a=p.apply(c,i))}}}catch(t){u.e(t)}finally{u.f()}return a};jQuery.fn[r]=function(r){if(!r)return a(this,null);if("object"===_typeof$6(r)){var o=r;return a(this,o)}if("string"===typeof r&&"_"!==r[0]){var i=r;if("destroy"===i)return l(this);if("get_widget_class"===i)return t;for(var d=arguments.length,c=new Array(d>1?d-1:0),h=1;h<d;h++)c[h-1]=arguments[h];return u(this,i,c)}}};var E=function(){function SimpleWidget(t,r){_classCallCheck$6(this,SimpleWidget);_defineProperty$6(this,"options",void 0);_defineProperty$6(this,"$el",void 0);this.$el=jQuery(t);var o=this.constructor.defaults;this.options=_objectSpread$1(_objectSpread$1({},o),r)}_createClass$6(SimpleWidget,[{key:"destroy",value:function destroy(){this.deinit()}},{key:"init",value:function init(){}},{key:"deinit",value:function deinit(){}}],[{key:"register",value:function register(t,r){T(t,r)}}]);return SimpleWidget}();D.default=E;_defineProperty$6(E,"defaults",{});var A={};Object.defineProperty(A,"__esModule",{value:true});A.default=void 0;var H=_interopRequireDefault$1(D);function _interopRequireDefault$1(t){return t&&t.__esModule?t:{default:t}}function _typeof$5(t){return _typeof$5="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$5(t)}function _classCallCheck$5(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties$5(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,_toPropertyKey$5(i.key),i)}}function _createClass$5(t,r,o){r&&_defineProperties$5(t.prototype,r);o&&_defineProperties$5(t,o);Object.defineProperty(t,"prototype",{writable:false});return t}function _inherits$2(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:true,configurable:true}});Object.defineProperty(t,"prototype",{writable:false});r&&_setPrototypeOf$2(t,r)}function _setPrototypeOf$2(t,r){_setPrototypeOf$2=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(t,r){t.__proto__=r;return t};return _setPrototypeOf$2(t,r)}function _createSuper$2(t){var r=_isNativeReflectConstruct$2();return function _createSuperInternal(){var o,i=_getPrototypeOf$2(t);if(r){var a=_getPrototypeOf$2(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn$2(this,o)}}function _possibleConstructorReturn$2(t,r){if(r&&("object"===_typeof$5(r)||"function"===typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$2(t)}function _assertThisInitialized$2(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct$2(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return true}catch(t){return false}}function _getPrototypeOf$2(t){_getPrototypeOf$2=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)};return _getPrototypeOf$2(t)}function _defineProperty$5(t,r,o){r=_toPropertyKey$5(r);r in t?Object.defineProperty(t,r,{value:o,enumerable:true,configurable:true,writable:true}):t[r]=o;return t}function _toPropertyKey$5(t){var r=_toPrimitive$5(t,"string");return"symbol"===_typeof$5(r)?r:String(r)}function _toPrimitive$5(t,r){if("object"!==_typeof$5(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==_typeof$5(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var W=function getPositionInfoFromMouseEvent(t){return{pageX:t.pageX,pageY:t.pageY,target:t.target,originalEvent:t}};var L=function getPositionInfoFromTouch(t,r){return{pageX:t.pageX,pageY:t.pageY,target:t.target,originalEvent:r}};var M=function(t){_inherits$2(MouseWidget,t);var r=_createSuper$2(MouseWidget);function MouseWidget(){var t;_classCallCheck$5(this,MouseWidget);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];t=r.call.apply(r,[this].concat(i));_defineProperty$5(_assertThisInitialized$2(t),"isMouseStarted",void 0);_defineProperty$5(_assertThisInitialized$2(t),"mouseDownInfo",void 0);_defineProperty$5(_assertThisInitialized$2(t),"mouseDelayTimer",void 0);_defineProperty$5(_assertThisInitialized$2(t),"isMouseDelayMet",void 0);_defineProperty$5(_assertThisInitialized$2(t),"mouseDown",(function(r){if(0===r.button){var o=t.handleMouseDown(W(r));o&&r.cancelable&&r.preventDefault()}}));_defineProperty$5(_assertThisInitialized$2(t),"mouseMove",(function(r){t.handleMouseMove(r,W(r))}));_defineProperty$5(_assertThisInitialized$2(t),"mouseUp",(function(r){t.handleMouseUp(W(r))}));_defineProperty$5(_assertThisInitialized$2(t),"touchStart",(function(r){if(r&&!(r.touches.length>1)){var o=r.changedTouches[0];t.handleMouseDown(L(o,r))}}));_defineProperty$5(_assertThisInitialized$2(t),"touchMove",(function(r){if(r&&!(r.touches.length>1)){var o=r.changedTouches[0];t.handleMouseMove(r,L(o,r))}}));_defineProperty$5(_assertThisInitialized$2(t),"touchEnd",(function(r){if(r&&!(r.touches.length>1)){var o=r.changedTouches[0];t.handleMouseUp(L(o,r))}}));return t}_createClass$5(MouseWidget,[{key:"init",value:function init(){var t=this.$el.get(0);if(t){t.addEventListener("mousedown",this.mouseDown,{passive:false});t.addEventListener("touchstart",this.touchStart,{passive:false})}this.isMouseStarted=false;this.mouseDelayTimer=null;this.isMouseDelayMet=false;this.mouseDownInfo=null}},{key:"deinit",value:function deinit(){var t=this.$el.get(0);if(t){t.removeEventListener("mousedown",this.mouseDown,{passive:false});t.removeEventListener("touchstart",this.touchStart,{passive:false})}this.removeMouseMoveEventListeners()}},{key:"handleMouseDown",value:function handleMouseDown(t){this.isMouseStarted&&this.handleMouseUp(t);this.mouseDownInfo=t;if(!this.mouseCapture(t))return false;this.handleStartMouse();return true}},{key:"handleStartMouse",value:function handleStartMouse(){document.addEventListener("mousemove",this.mouseMove,{passive:false});document.addEventListener("touchmove",this.touchMove,{passive:false});document.addEventListener("mouseup",this.mouseUp,{passive:false});document.addEventListener("touchend",this.touchEnd,{passive:false});var t=this.getMouseDelay();t?this.startMouseDelayTimer(t):this.isMouseDelayMet=true}},{key:"startMouseDelayTimer",value:function startMouseDelayTimer(t){var r=this;this.mouseDelayTimer&&clearTimeout(this.mouseDelayTimer);this.mouseDelayTimer=window.setTimeout((function(){r.mouseDownInfo&&(r.isMouseDelayMet=true)}),t);this.isMouseDelayMet=false}},{key:"handleMouseMove",value:function handleMouseMove(t,r){if(this.isMouseStarted){this.mouseDrag(r);t.cancelable&&t.preventDefault()}else if(this.isMouseDelayMet){this.mouseDownInfo&&(this.isMouseStarted=false!==this.mouseStart(this.mouseDownInfo));if(this.isMouseStarted){this.mouseDrag(r);t.cancelable&&t.preventDefault()}else this.handleMouseUp(r)}}},{key:"handleMouseUp",value:function handleMouseUp(t){this.removeMouseMoveEventListeners();this.isMouseDelayMet=false;this.mouseDownInfo=null;if(this.isMouseStarted){this.isMouseStarted=false;this.mouseStop(t)}}},{key:"removeMouseMoveEventListeners",value:function removeMouseMoveEventListeners(){document.removeEventListener("mousemove",this.mouseMove,{passive:false});document.removeEventListener("touchmove",this.touchMove,{passive:false});document.removeEventListener("mouseup",this.mouseUp,{passive:false});document.removeEventListener("touchend",this.touchEnd,{passive:false})}}]);return MouseWidget}(H.default);var B=M;A.default=B;var x={};Object.defineProperty(x,"__esModule",{value:true});x.default=void 0;var q=b;function _typeof$4(t){return _typeof$4="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$4(t)}function _createForOfIteratorHelper$2(t,r){var o="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=_unsupportedIterableToArray$2(t))||r&&t&&"number"===typeof t.length){o&&(t=o);var i=0;var a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:true}:{done:false,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,u=true,d=false;return{s:function s(){o=o.call(t)},n:function n(){var t=o.next();u=t.done;return t},e:function e(t){d=true;l=t},f:function f(){try{u||null==o.return||o.return()}finally{if(d)throw l}}}}function _unsupportedIterableToArray$2(t,r){if(t){if("string"===typeof t)return _arrayLikeToArray$2(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);return"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray$2(t,r):void 0}}function _arrayLikeToArray$2(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _classCallCheck$4(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties$4(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,_toPropertyKey$4(i.key),i)}}function _createClass$4(t,r,o){r&&_defineProperties$4(t.prototype,r);o&&_defineProperties$4(t,o);Object.defineProperty(t,"prototype",{writable:false});return t}function _defineProperty$4(t,r,o){r=_toPropertyKey$4(r);r in t?Object.defineProperty(t,r,{value:o,enumerable:true,configurable:true,writable:true}):t[r]=o;return t}function _toPropertyKey$4(t){var r=_toPrimitive$4(t,"string");return"symbol"===_typeof$4(r)?r:String(r)}function _toPrimitive$4(t,r){if("object"!==_typeof$4(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==_typeof$4(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var R=function(){function SaveStateHandler(t){_classCallCheck$4(this,SaveStateHandler);_defineProperty$4(this,"treeWidget",void 0);_defineProperty$4(this,"_supportsLocalStorage",void 0);this.treeWidget=t}_createClass$4(SaveStateHandler,[{key:"saveState",value:function saveState(){var t=JSON.stringify(this.getState());this.treeWidget.options.onSetStateFromStorage?this.treeWidget.options.onSetStateFromStorage(t):this.supportsLocalStorage()&&localStorage.setItem(this.getKeyName(),t)}},{key:"getStateFromStorage",value:function getStateFromStorage(){var t=this.loadFromStorage();return t?this.parseState(t):null}},{key:"getState",value:function getState(){var t=this;var r=function getOpenNodeIds(){var r=[];t.treeWidget.tree.iterate((function(t){t.is_open&&t.id&&t.hasChildren()&&r.push(t.id);return true}));return r};var o=function getSelectedNodeIds(){var r=[];t.treeWidget.getSelectedNodes().forEach((function(t){null!=t.id&&r.push(t.id)}));return r};return{open_nodes:r(),selected_node:o()}}},{key:"setInitialState",value:function setInitialState(t){if(t){var r=false;t.open_nodes&&(r=this.openInitialNodes(t.open_nodes));if(t.selected_node){this.resetSelection();this.selectInitialNodes(t.selected_node)}return r}return false}},{key:"setInitialStateOnDemand",value:function setInitialStateOnDemand(t,r){t?this.doSetInitialStateOnDemand(t.open_nodes,t.selected_node,r):r()}},{key:"getNodeIdToBeSelected",value:function getNodeIdToBeSelected(){var t=this.getStateFromStorage();return t&&t.selected_node?t.selected_node[0]:null}},{key:"parseState",value:function parseState(t){var r=JSON.parse(t);r&&r.selected_node&&(0,q.isInt)(r.selected_node)&&(r.selected_node=[r.selected_node]);return r}},{key:"loadFromStorage",value:function loadFromStorage(){return this.treeWidget.options.onGetStateFromStorage?this.treeWidget.options.onGetStateFromStorage():this.supportsLocalStorage()?localStorage.getItem(this.getKeyName()):null}},{key:"openInitialNodes",value:function openInitialNodes(t){var r=false;var o,i=_createForOfIteratorHelper$2(t);try{for(i.s();!(o=i.n()).done;){var a=o.value;var l=this.treeWidget.getNodeById(a);l&&(l.load_on_demand?r=true:l.is_open=true)}}catch(t){i.e(t)}finally{i.f()}return r}},{key:"selectInitialNodes",value:function selectInitialNodes(t){var r=0;var o,i=_createForOfIteratorHelper$2(t);try{for(i.s();!(o=i.n()).done;){var a=o.value;var l=this.treeWidget.getNodeById(a);if(l){r+=1;this.treeWidget.selectNodeHandler.addToSelection(l)}}}catch(t){i.e(t)}finally{i.f()}return 0!==r}},{key:"resetSelection",value:function resetSelection(){var t=this.treeWidget.selectNodeHandler;var r=t.getSelectedNodes();r.forEach((function(r){t.removeFromSelection(r)}))}},{key:"doSetInitialStateOnDemand",value:function doSetInitialStateOnDemand(t,r,o){var i=this;var a=0;var l=t;var u=function openNodes(){var t=[];var u,c=_createForOfIteratorHelper$2(l);try{for(c.s();!(u=c.n()).done;){var h=u.value;var p=i.treeWidget.getNodeById(h);p?p.is_loading||(p.load_on_demand?d(p):i.treeWidget._openNode(p,false,null)):t.push(h)}}catch(t){c.e(t)}finally{c.f()}l=t;i.selectInitialNodes(r)&&i.treeWidget._refreshElements(null);0===a&&o()};var d=function loadAndOpenNode(t){a+=1;i.treeWidget._openNode(t,false,(function(){a-=1;u()}))};u()}},{key:"getKeyName",value:function getKeyName(){return"string"===typeof this.treeWidget.options.saveState?this.treeWidget.options.saveState:"tree"}},{key:"supportsLocalStorage",value:function supportsLocalStorage(){var t=function testSupport(){if(null==localStorage)return false;try{var t="_storage_test";sessionStorage.setItem(t,"value");sessionStorage.removeItem(t)}catch(t){return false}return true};null==this._supportsLocalStorage&&(this._supportsLocalStorage=t());return this._supportsLocalStorage}}]);return SaveStateHandler}();x.default=R;var K={};Object.defineProperty(K,"__esModule",{value:true});K.default=void 0;function _typeof$3(t){return _typeof$3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$3(t)}function _createForOfIteratorHelper$1(t,r){var o="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=_unsupportedIterableToArray$1(t))||r&&t&&"number"===typeof t.length){o&&(t=o);var i=0;var a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:true}:{done:false,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,u=true,d=false;return{s:function s(){o=o.call(t)},n:function n(){var t=o.next();u=t.done;return t},e:function e(t){d=true;l=t},f:function f(){try{u||null==o.return||o.return()}finally{if(d)throw l}}}}function _unsupportedIterableToArray$1(t,r){if(t){if("string"===typeof t)return _arrayLikeToArray$1(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);return"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray$1(t,r):void 0}}function _arrayLikeToArray$1(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _classCallCheck$3(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties$3(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,_toPropertyKey$3(i.key),i)}}function _createClass$3(t,r,o){r&&_defineProperties$3(t.prototype,r);o&&_defineProperties$3(t,o);Object.defineProperty(t,"prototype",{writable:false});return t}function _defineProperty$3(t,r,o){r=_toPropertyKey$3(r);r in t?Object.defineProperty(t,r,{value:o,enumerable:true,configurable:true,writable:true}):t[r]=o;return t}function _toPropertyKey$3(t){var r=_toPrimitive$3(t,"string");return"symbol"===_typeof$3(r)?r:String(r)}function _toPrimitive$3(t,r){if("object"!==_typeof$3(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==_typeof$3(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var U=function(){function ScrollHandler(t){_classCallCheck$3(this,ScrollHandler);_defineProperty$3(this,"treeWidget",void 0);_defineProperty$3(this,"previousTop",void 0);_defineProperty$3(this,"isInitialized",void 0);_defineProperty$3(this,"$scrollParent",void 0);_defineProperty$3(this,"scrollParentTop",void 0);this.treeWidget=t;this.previousTop=-1;this.isInitialized=false}_createClass$3(ScrollHandler,[{key:"checkScrolling",value:function checkScrolling(){this.ensureInit();this.checkVerticalScrolling();this.checkHorizontalScrolling()}},{key:"scrollToY",value:function scrollToY(t){this.ensureInit();if(this.$scrollParent)this.$scrollParent[0].scrollTop=t;else{var r=this.treeWidget.$el.offset();var o=r?r.top:0;jQuery(document).scrollTop(t+o)}}},{key:"isScrolledIntoView",value:function isScrolledIntoView(t){this.ensureInit();var r;var o;var i;var a;var l=t.height()||0;if(this.$scrollParent){a=0;o=this.$scrollParent.height()||0;var u=t.offset();var d=u?u.top:0;i=d-this.scrollParentTop;r=i+l}else{a=jQuery(window).scrollTop()||0;var c=jQuery(window).height()||0;o=a+c;var h=t.offset();i=h?h.top:0;r=i+l}return r<=o&&i>=a}},{key:"getScrollLeft",value:function getScrollLeft(){return this.$scrollParent&&this.$scrollParent.scrollLeft()||0}},{key:"initScrollParent",value:function initScrollParent(){var t=this;var r=function getParentWithOverflow(){var r=["overflow","overflow-y"];var o=function hasOverFlow(t){for(var o=0,i=r;o<i.length;o++){var a=i[o];var l=t.css(a);if("auto"===l||"scroll"===l)return true}return false};if(o(t.treeWidget.$el))return t.treeWidget.$el;var i,a=_createForOfIteratorHelper$1(t.treeWidget.$el.parents().get());try{for(a.s();!(i=a.n()).done;){var l=i.value;var u=jQuery(l);if(o(u))return u}}catch(t){a.e(t)}finally{a.f()}return null};var o=function setDocumentAsScrollParent(){t.scrollParentTop=0;t.$scrollParent=null};"fixed"===this.treeWidget.$el.css("position")&&o();var i=r();if(i&&i.length&&"HTML"!==i[0].tagName){this.$scrollParent=i;var a=this.$scrollParent.offset();this.scrollParentTop=a?a.top:0}else o();this.isInitialized=true}},{key:"ensureInit",value:function ensureInit(){this.isInitialized||this.initScrollParent()}},{key:"handleVerticalScrollingWithScrollParent",value:function handleVerticalScrollingWithScrollParent(t){var r=this.$scrollParent&&this.$scrollParent[0];if(r){var o=this.scrollParentTop+r.offsetHeight-t.bottom;if(o<20){r.scrollTop+=20;this.treeWidget.refreshHitAreas();this.previousTop=-1}else if(t.top-this.scrollParentTop<20){r.scrollTop-=20;this.treeWidget.refreshHitAreas();this.previousTop=-1}}}},{key:"handleVerticalScrollingWithDocument",value:function handleVerticalScrollingWithDocument(t){var r=jQuery(document).scrollTop()||0;var o=t.top-r;if(o<20)jQuery(document).scrollTop(r-20);else{var i=jQuery(window).height()||0;i-(t.bottom-r)<20&&jQuery(document).scrollTop(r+20)}}},{key:"checkVerticalScrolling",value:function checkVerticalScrolling(){var t=this.treeWidget.dndHandler.hoveredArea;if(t&&t.top!==this.previousTop){this.previousTop=t.top;this.$scrollParent?this.handleVerticalScrollingWithScrollParent(t):this.handleVerticalScrollingWithDocument(t)}}},{key:"checkHorizontalScrolling",value:function checkHorizontalScrolling(){var t=this.treeWidget.dndHandler.positionInfo;t&&(this.$scrollParent?this.handleHorizontalScrollingWithParent(t):this.handleHorizontalScrollingWithDocument(t))}},{key:"handleHorizontalScrollingWithParent",value:function handleHorizontalScrollingWithParent(t){if(void 0!==t.pageX&&void 0!==t.pageY){var r=this.$scrollParent;var o=r&&r.offset();if(r&&o){var i=r[0];var a=i.scrollLeft+i.clientWidth<i.scrollWidth;var l=i.scrollLeft>0;var u=o.left+i.clientWidth;var d=o.left;var c=t.pageX>u-20;var h=t.pageX<d+20;c&&a?i.scrollLeft=Math.min(i.scrollLeft+20,i.scrollWidth):h&&l&&(i.scrollLeft=Math.max(i.scrollLeft-20,0))}}}},{key:"handleHorizontalScrollingWithDocument",value:function handleHorizontalScrollingWithDocument(t){if(void 0!==t.pageX&&void 0!==t.pageY){var r=jQuery(document);var o=r.scrollLeft()||0;var i=jQuery(window).width()||0;var a=o>0;var l=t.pageX>i-20;var u=t.pageX-o<20;l?r.scrollLeft(o+20):u&&a&&r.scrollLeft(Math.max(o-20,0))}}}]);return ScrollHandler}();K.default=U;var z={};Object.defineProperty(z,"__esModule",{value:true});z.default=void 0;function _typeof$2(t){return _typeof$2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$2(t)}function _classCallCheck$2(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties$2(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,_toPropertyKey$2(i.key),i)}}function _createClass$2(t,r,o){r&&_defineProperties$2(t.prototype,r);o&&_defineProperties$2(t,o);Object.defineProperty(t,"prototype",{writable:false});return t}function _defineProperty$2(t,r,o){r=_toPropertyKey$2(r);r in t?Object.defineProperty(t,r,{value:o,enumerable:true,configurable:true,writable:true}):t[r]=o;return t}function _toPropertyKey$2(t){var r=_toPrimitive$2(t,"string");return"symbol"===_typeof$2(r)?r:String(r)}function _toPrimitive$2(t,r){if("object"!==_typeof$2(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==_typeof$2(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var Q=function(){function SelectNodeHandler(t){_classCallCheck$2(this,SelectNodeHandler);_defineProperty$2(this,"treeWidget",void 0);_defineProperty$2(this,"selectedNodes",void 0);_defineProperty$2(this,"selectedSingleNode",void 0);this.treeWidget=t;this.selectedNodes=new Set;this.clear()}_createClass$2(SelectNodeHandler,[{key:"getSelectedNode",value:function getSelectedNode(){var t=this.getSelectedNodes();return!!t.length&&t[0]}},{key:"getSelectedNodes",value:function getSelectedNodes(){var t=this;if(this.selectedSingleNode)return[this.selectedSingleNode];var r=[];this.selectedNodes.forEach((function(o){var i=t.treeWidget.getNodeById(o);i&&r.push(i)}));return r}},{key:"getSelectedNodesUnder",value:function getSelectedNodesUnder(t){if(this.selectedSingleNode)return t.isParentOf(this.selectedSingleNode)?[this.selectedSingleNode]:[];var r=[];for(var o in this.selectedNodes)if(Object.prototype.hasOwnProperty.call(this.selectedNodes,o)){var i=this.treeWidget.getNodeById(o);i&&t.isParentOf(i)&&r.push(i)}return r}},{key:"isNodeSelected",value:function isNodeSelected(t){return null!=t.id?this.selectedNodes.has(t.id):!!this.selectedSingleNode&&this.selectedSingleNode.element===t.element}},{key:"clear",value:function clear(){this.selectedNodes.clear();this.selectedSingleNode=null}},{key:"removeFromSelection",value:function removeFromSelection(t){var r=this;var o=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null==t.id)this.selectedSingleNode&&t.element===this.selectedSingleNode.element&&(this.selectedSingleNode=null);else{this.selectedNodes.delete(t.id);o&&t.iterate((function(){null!=t.id&&r.selectedNodes.delete(t.id);return true}))}}},{key:"addToSelection",value:function addToSelection(t){null!=t.id?this.selectedNodes.add(t.id):this.selectedSingleNode=t}},{key:"isFocusOnTree",value:function isFocusOnTree(){var t=document.activeElement;return Boolean(t&&"SPAN"===t.tagName&&this.treeWidget._containsElement(t))}}]);return SelectNodeHandler}();z.default=Q;var G={};Object.defineProperty(G,"__esModule",{value:true});G.NodeElement=G.FolderElement=G.BorderDropHint=void 0;var V=i;function _typeof$1(t){return _typeof$1="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof$1(t)}function _inherits$1(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:true,configurable:true}});Object.defineProperty(t,"prototype",{writable:false});r&&_setPrototypeOf$1(t,r)}function _setPrototypeOf$1(t,r){_setPrototypeOf$1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(t,r){t.__proto__=r;return t};return _setPrototypeOf$1(t,r)}function _createSuper$1(t){var r=_isNativeReflectConstruct$1();return function _createSuperInternal(){var o,i=_getPrototypeOf$1(t);if(r){var a=_getPrototypeOf$1(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn$1(this,o)}}function _possibleConstructorReturn$1(t,r){if(r&&("object"===_typeof$1(r)||"function"===typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1(t)}function _assertThisInitialized$1(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct$1(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return true}catch(t){return false}}function _getPrototypeOf$1(t){_getPrototypeOf$1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)};return _getPrototypeOf$1(t)}function _classCallCheck$1(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,_toPropertyKey$1(i.key),i)}}function _createClass$1(t,r,o){r&&_defineProperties$1(t.prototype,r);o&&_defineProperties$1(t,o);Object.defineProperty(t,"prototype",{writable:false});return t}function _defineProperty$1(t,r,o){r=_toPropertyKey$1(r);r in t?Object.defineProperty(t,r,{value:o,enumerable:true,configurable:true,writable:true}):t[r]=o;return t}function _toPropertyKey$1(t){var r=_toPrimitive$1(t,"string");return"symbol"===_typeof$1(r)?r:String(r)}function _toPrimitive$1(t,r){if("object"!==_typeof$1(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==_typeof$1(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var J=function(){function NodeElement(t,r){_classCallCheck$1(this,NodeElement);_defineProperty$1(this,"node",void 0);_defineProperty$1(this,"$element",void 0);_defineProperty$1(this,"treeWidget",void 0);this.init(t,r)}_createClass$1(NodeElement,[{key:"init",value:function init(t,r){this.node=t;this.treeWidget=r;if(!t.element){var o=this.treeWidget.element.get(0);o&&(t.element=o)}t.element&&(this.$element=jQuery(t.element))}},{key:"addDropHint",value:function addDropHint(t){return this.mustShowBorderDropHint(t)?new Y(this.$element,this.treeWidget._getScrollLeft()):new Z(this.node,this.$element,t)}},{key:"select",value:function select(t){var r;var o=this.getLi();o.addClass("jqtree-selected");o.attr("aria-selected","true");var i=this.getSpan();i.attr("tabindex",null!==(r=this.treeWidget.options.tabIndex)&&void 0!==r?r:null);t&&i.trigger("focus")}},{key:"deselect",value:function deselect(){var t=this.getLi();t.removeClass("jqtree-selected");t.attr("aria-selected","false");var r=this.getSpan();r.removeAttr("tabindex");r.blur()}},{key:"getUl",value:function getUl(){return this.$element.children("ul:first")}},{key:"getSpan",value:function getSpan(){return this.$element.children(".jqtree-element").find("span.jqtree-title")}},{key:"getLi",value:function getLi(){return this.$element}},{key:"mustShowBorderDropHint",value:function mustShowBorderDropHint(t){return t===V.Position.Inside}}]);return NodeElement}();G.NodeElement=J;var X=function(t){_inherits$1(FolderElement,t);var r=_createSuper$1(FolderElement);function FolderElement(){_classCallCheck$1(this,FolderElement);return r.apply(this,arguments)}_createClass$1(FolderElement,[{key:"open",value:function open(t){var r=this;var o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"fast";if(!this.node.is_open){this.node.is_open=true;var a=this.getButton();a.removeClass("jqtree-closed");a.html("");var l=a.get(0);if(l){var u=this.treeWidget.renderer.openedIconElement.cloneNode(true);l.appendChild(u)}var d=function doOpen(){var o=r.getLi();o.removeClass("jqtree-closed");var i=r.getSpan();i.attr("aria-expanded","true");t&&t(r.node);r.treeWidget._triggerEvent("tree.open",{node:r.node})};if(o)this.getUl().slideDown(i,d);else{this.getUl().show();d()}}}},{key:"close",value:function close(){var t=this;var r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"fast";if(this.node.is_open){this.node.is_open=false;var i=this.getButton();i.addClass("jqtree-closed");i.html("");var a=i.get(0);if(a){var l=this.treeWidget.renderer.closedIconElement.cloneNode(true);a.appendChild(l)}var u=function doClose(){var r=t.getLi();r.addClass("jqtree-closed");var o=t.getSpan();o.attr("aria-expanded","false");t.treeWidget._triggerEvent("tree.close",{node:t.node})};if(r)this.getUl().slideUp(o,u);else{this.getUl().hide();u()}}}},{key:"mustShowBorderDropHint",value:function mustShowBorderDropHint(t){return!this.node.is_open&&t===V.Position.Inside}},{key:"getButton",value:function getButton(){return this.$element.children(".jqtree-element").find("a.jqtree-toggler")}}]);return FolderElement}(J);G.FolderElement=X;var Y=function(){function BorderDropHint(t,r){_classCallCheck$1(this,BorderDropHint);_defineProperty$1(this,"$hint",void 0);var o=t.children(".jqtree-element");var i=t.width()||0;var a=Math.max(i+r-4,0);var l=o.outerHeight()||0;var u=Math.max(l-4,0);this.$hint=jQuery('<span class="jqtree-border"></span>');o.append(this.$hint);this.$hint.css({width:a,height:u})}_createClass$1(BorderDropHint,[{key:"remove",value:function remove(){this.$hint.remove()}}]);return BorderDropHint}();G.BorderDropHint=Y;var Z=function(){function GhostDropHint(t,r,o){_classCallCheck$1(this,GhostDropHint);_defineProperty$1(this,"$element",void 0);_defineProperty$1(this,"node",void 0);_defineProperty$1(this,"$ghost",void 0);this.$element=r;this.node=t;this.$ghost=jQuery('<li class="jqtree_common jqtree-ghost"><span class="jqtree_common jqtree-circle"></span>\n            <span class="jqtree_common jqtree-line"></span></li>');o===V.Position.After?this.moveAfter():o===V.Position.Before?this.moveBefore():o===V.Position.Inside&&(t.isFolder()&&t.is_open?this.moveInsideOpenFolder():this.moveInside())}_createClass$1(GhostDropHint,[{key:"remove",value:function remove(){this.$ghost.remove()}},{key:"moveAfter",value:function moveAfter(){this.$element.after(this.$ghost)}},{key:"moveBefore",value:function moveBefore(){this.$element.before(this.$ghost)}},{key:"moveInsideOpenFolder",value:function moveInsideOpenFolder(){var t=this.node.children[0].element;t&&jQuery(t).before(this.$ghost)}},{key:"moveInside",value:function moveInside(){this.$element.after(this.$ghost);this.$ghost.addClass("jqtree-inside")}}]);return GhostDropHint}();var ee={};Object.defineProperty(ee,"__esModule",{value:true});ee.JqTreeWidget=void 0;var te=_interopRequireDefault(t);var re=p;var ne=_interopRequireDefault(N);var oe=_interopRequireDefault(w);var ie=_interopRequireDefault(C);var ae=_interopRequireDefault(A);var le=_interopRequireDefault(x);var se=_interopRequireDefault(K);var ue=_interopRequireDefault(z);var de=_interopRequireDefault(D);var fe=i;var ce=b;var he=G;function _interopRequireDefault(t){return t&&t.__esModule?t:{default:t}}function _createForOfIteratorHelper(t,r){var o="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!o){if(Array.isArray(t)||(o=_unsupportedIterableToArray(t))||r&&t&&"number"===typeof t.length){o&&(t=o);var i=0;var a=function F(){};return{s:a,n:function n(){return i>=t.length?{done:true}:{done:false,value:t[i++]}},e:function e(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,u=true,d=false;return{s:function s(){o=o.call(t)},n:function n(){var t=o.next();u=t.done;return t},e:function e(t){d=true;l=t},f:function f(){try{u||null==o.return||o.return()}finally{if(d)throw l}}}}function ownKeys(t,r){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);r&&(i=i.filter((function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable}))),o.push.apply(o,i)}return o}function _objectSpread(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(o),!0).forEach((function(r){_defineProperty(t,r,o[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):ownKeys(Object(o)).forEach((function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(o,r))}))}return t}function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _slicedToArray(t,r){return _arrayWithHoles(t)||_iterableToArrayLimit(t,r)||_unsupportedIterableToArray(t,r)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,r){if(t){if("string"===typeof t)return _arrayLikeToArray(t,r);var o=Object.prototype.toString.call(t).slice(8,-1);"Object"===o&&t.constructor&&(o=t.constructor.name);return"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?_arrayLikeToArray(t,r):void 0}}function _arrayLikeToArray(t,r){(null==r||r>t.length)&&(r=t.length);for(var o=0,i=new Array(r);o<r;o++)i[o]=t[o];return i}function _iterableToArrayLimit(t,r){var o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var i,a,l,u,d=[],c=!0,h=!1;try{if(l=(o=o.call(t)).next,0===r){if(Object(o)!==o)return;c=!1}else for(;!(c=(i=l.call(o)).done)&&(d.push(i.value),d.length!==r);c=!0);}catch(t){h=!0,a=t}finally{try{if(!c&&null!=o.return&&(u=o.return(),Object(u)!==u))return}finally{if(h)throw a}}return d}}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _classCallCheck(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,r){for(var o=0;o<r.length;o++){var i=r[o];i.enumerable=i.enumerable||false;i.configurable=true;"value"in i&&(i.writable=true);Object.defineProperty(t,_toPropertyKey(i.key),i)}}function _createClass(t,r,o){r&&_defineProperties(t.prototype,r);o&&_defineProperties(t,o);Object.defineProperty(t,"prototype",{writable:false});return t}function _get(){_get="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function _get(t,r,o){var i=_superPropBase(t,r);if(i){var a=Object.getOwnPropertyDescriptor(i,r);return a.get?a.get.call(arguments.length<3?t:o):a.value}};return _get.apply(this,arguments)}function _superPropBase(t,r){while(!Object.prototype.hasOwnProperty.call(t,r)){t=_getPrototypeOf(t);if(null===t)break}return t}function _inherits(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,writable:true,configurable:true}});Object.defineProperty(t,"prototype",{writable:false});r&&_setPrototypeOf(t,r)}function _setPrototypeOf(t,r){_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(t,r){t.__proto__=r;return t};return _setPrototypeOf(t,r)}function _createSuper(t){var r=_isNativeReflectConstruct();return function _createSuperInternal(){var o,i=_getPrototypeOf(t);if(r){var a=_getPrototypeOf(this).constructor;o=Reflect.construct(i,arguments,a)}else o=i.apply(this,arguments);return _possibleConstructorReturn(this,o)}}function _possibleConstructorReturn(t,r){if(r&&("object"===_typeof(r)||"function"===typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(t)}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _isNativeReflectConstruct(){if("undefined"===typeof Reflect||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if("function"===typeof Proxy)return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return true}catch(t){return false}}function _getPrototypeOf(t){_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(t){return t.__proto__||Object.getPrototypeOf(t)};return _getPrototypeOf(t)}function _defineProperty(t,r,o){r=_toPropertyKey(r);r in t?Object.defineProperty(t,r,{value:o,enumerable:true,configurable:true,writable:true}):t[r]=o;return t}function _toPropertyKey(t){var r=_toPrimitive(t,"string");return"symbol"===_typeof(r)?r:String(r)}function _toPrimitive(t,r){if("object"!==_typeof(t)||null===t)return t;var o=t[Symbol.toPrimitive];if(void 0!==o){var i=o.call(t,r||"default");if("object"!==_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}var pe="Node parameter is empty";var ve="Parameter is empty: ";var ye=function(t){_inherits(JqTreeWidget,t);var r=_createSuper(JqTreeWidget);function JqTreeWidget(){var t;_classCallCheck(this,JqTreeWidget);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];t=r.call.apply(r,[this].concat(i));_defineProperty(_assertThisInitialized(t),"element",void 0);_defineProperty(_assertThisInitialized(t),"tree",void 0);_defineProperty(_assertThisInitialized(t),"dndHandler",void 0);_defineProperty(_assertThisInitialized(t),"renderer",void 0);_defineProperty(_assertThisInitialized(t),"dataLoader",void 0);_defineProperty(_assertThisInitialized(t),"scrollHandler",void 0);_defineProperty(_assertThisInitialized(t),"selectNodeHandler",void 0);_defineProperty(_assertThisInitialized(t),"isInitialized",void 0);_defineProperty(_assertThisInitialized(t),"saveStateHandler",void 0);_defineProperty(_assertThisInitialized(t),"keyHandler",void 0);_defineProperty(_assertThisInitialized(t),"handleClick",(function(r){var o=t.getClickTarget(r.target);if(o)if("button"===o.type){t.toggle(o.node,t.options.slide);r.preventDefault();r.stopPropagation()}else if("label"===o.type){var i=o.node;var a=t._triggerEvent("tree.click",{node:i,click_event:r});a.isDefaultPrevented()||t.doSelectNode(i)}}));_defineProperty(_assertThisInitialized(t),"handleDblclick",(function(r){var o=t.getClickTarget(r.target);"label"===(null===o||void 0===o?void 0:o.type)&&t._triggerEvent("tree.dblclick",{node:o.node,click_event:r})}));_defineProperty(_assertThisInitialized(t),"handleContextmenu",(function(r){var o=jQuery(r.target).closest("ul.jqtree-tree .jqtree-element");if(o.length){var i=t.getNode(o);if(i){r.preventDefault();r.stopPropagation();t._triggerEvent("tree.contextmenu",{node:i,click_event:r});return false}}return null}));return t}_createClass(JqTreeWidget,[{key:"toggle",value:function toggle(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t)throw Error(pe);var o=null!==r&&void 0!==r?r:this.options.slide;t.is_open?this.closeNode(t,o):this.openNode(t,o);return this.element}},{key:"getTree",value:function getTree(){return this.tree}},{key:"selectNode",value:function selectNode(t,r){this.doSelectNode(t,r);return this.element}},{key:"getSelectedNode",value:function getSelectedNode(){return this.selectNodeHandler.getSelectedNode()}},{key:"toJson",value:function toJson(){return JSON.stringify(this.tree.getData())}},{key:"loadData",value:function loadData(t,r){this.doLoadData(t,r);return this.element}},{key:"loadDataFromUrl",value:function loadDataFromUrl(t,r,o){"string"===typeof t?this.doLoadDataFromUrl(t,r,null!==o&&void 0!==o?o:null):this.doLoadDataFromUrl(null,t,r);return this.element}},{key:"reload",value:function reload(t){this.doLoadDataFromUrl(null,null,t);return this.element}},{key:"refresh",value:function refresh(){this._refreshElements(null);return this.element}},{key:"getNodeById",value:function getNodeById(t){return this.tree.getNodeById(t)}},{key:"getNodeByName",value:function getNodeByName(t){return this.tree.getNodeByName(t)}},{key:"getNodeByNameMustExist",value:function getNodeByNameMustExist(t){return this.tree.getNodeByNameMustExist(t)}},{key:"getNodesByProperty",value:function getNodesByProperty(t,r){return this.tree.getNodesByProperty(t,r)}},{key:"getNodeByHtmlElement",value:function getNodeByHtmlElement(t){return this.getNode(jQuery(t))}},{key:"getNodeByCallback",value:function getNodeByCallback(t){return this.tree.getNodeByCallback(t)}},{key:"openNode",value:function openNode(t,r,o){var i=this;if(!t)throw Error(pe);var a=function parseParams(){var t;var a;if((0,ce.isFunction)(r)){t=r;a=null}else{a=r;t=o}if(null==a){var l;a=null!==(l=i.options.slide)&&void 0!==l&&l}return[a,t]};var l=a(),u=_slicedToArray(l,2),d=u[0],c=u[1];this._openNode(t,d,c);return this.element}},{key:"closeNode",value:function closeNode(t,r){if(!t)throw Error(pe);var o=null!==r&&void 0!==r?r:this.options.slide;if(t.isFolder()||t.isEmptyFolder){new he.FolderElement(t,this).close(o,this.options.animationSpeed);this.saveState()}return this.element}},{key:"isDragging",value:function isDragging(){return this.dndHandler.isDragging}},{key:"refreshHitAreas",value:function refreshHitAreas(){this.dndHandler.refresh();return this.element}},{key:"addNodeAfter",value:function addNodeAfter(t,r){var o=r.addAfter(t);o&&this._refreshElements(r.parent);return o}},{key:"addNodeBefore",value:function addNodeBefore(t,r){if(!r)throw Error(ve+"existingNode");var o=r.addBefore(t);o&&this._refreshElements(r.parent);return o}},{key:"addParentNode",value:function addParentNode(t,r){if(!r)throw Error(ve+"existingNode");var o=r.addParent(t);o&&this._refreshElements(o.parent);return o}},{key:"removeNode",value:function removeNode(t){if(!t)throw Error(pe);if(!t.parent)throw Error("Node has no parent");this.selectNodeHandler.removeFromSelection(t,true);var r=t.parent;t.remove();this._refreshElements(r);return this.element}},{key:"appendNode",value:function appendNode(t,r){var o=r||this.tree;var i=o.append(t);this._refreshElements(o);return i}},{key:"prependNode",value:function prependNode(t,r){var o=null!==r&&void 0!==r?r:this.tree;var i=o.prepend(t);this._refreshElements(o);return i}},{key:"updateNode",value:function updateNode(t,r){if(!t)throw Error(pe);var o="object"===_typeof(r)&&r.id&&r.id!==t.id;o&&this.tree.removeNodeFromIndex(t);t.setData(r);o&&this.tree.addNodeToIndex(t);if("object"===_typeof(r)&&r.children&&r.children instanceof Array){t.removeChildren();r.children.length&&t.loadFromData(r.children)}this._refreshElements(t);return this.element}},{key:"isSelectedNodeInSubtree",value:function isSelectedNodeInSubtree(t){var r=this.getSelectedNode();return!!r&&(t===r||t.isParentOf(r))}},{key:"moveNode",value:function moveNode(t,r,o){if(!t)throw Error(pe);if(!r)throw Error(ve+"targetNode");var i=(0,fe.getPosition)(o);if(void 0!==i){this.tree.moveNode(t,r,i);this._refreshElements(null)}return this.element}},{key:"getStateFromStorage",value:function getStateFromStorage(){return this.saveStateHandler.getStateFromStorage()}},{key:"addToSelection",value:function addToSelection(t,r){if(!t)throw Error(pe);this.selectNodeHandler.addToSelection(t);this._getNodeElementForNode(t).select(void 0===r||r);this.saveState();return this.element}},{key:"getSelectedNodes",value:function getSelectedNodes(){return this.selectNodeHandler.getSelectedNodes()}},{key:"isNodeSelected",value:function isNodeSelected(t){if(!t)throw Error(pe);return this.selectNodeHandler.isNodeSelected(t)}},{key:"removeFromSelection",value:function removeFromSelection(t){if(!t)throw Error(pe);this.selectNodeHandler.removeFromSelection(t);this._getNodeElementForNode(t).deselect();this.saveState();return this.element}},{key:"scrollToNode",value:function scrollToNode(t){if(!t)throw Error(pe);var r=jQuery(t.element).offset();var o=r?r.top:0;var i=this.$el.offset();var a=i?i.top:0;var l=o-a;this.scrollHandler.scrollToY(l);return this.element}},{key:"getState",value:function getState(){return this.saveStateHandler.getState()}},{key:"setState",value:function setState(t){this.saveStateHandler.setInitialState(t);this._refreshElements(null);return this.element}},{key:"setOption",value:function setOption(t,r){this.options[t]=r;return this.element}},{key:"moveDown",value:function moveDown(){var t=this.getSelectedNode();t&&this.keyHandler.moveDown(t);return this.element}},{key:"moveUp",value:function moveUp(){var t=this.getSelectedNode();t&&this.keyHandler.moveUp(t);return this.element}},{key:"getVersion",value:function getVersion(){return te.default}},{key:"_triggerEvent",value:function _triggerEvent(t,r){var o=jQuery.Event(t,r);this.element.trigger(o);return o}},{key:"_openNode",value:function _openNode(t){var r=this;var o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var i=arguments.length>2?arguments[2]:void 0;var a=function doOpenNode(t,o,i){var a=new he.FolderElement(t,r);a.open(i,o,r.options.animationSpeed)};if(t.isFolder()||t.isEmptyFolder)if(t.load_on_demand)this.loadFolderOnDemand(t,o,i);else{var l=t.parent;while(l){l.parent&&a(l,false,null);l=l.parent}a(t,o,i);this.saveState()}}},{key:"_refreshElements",value:function _refreshElements(t){var r=this.selectNodeHandler.isFocusOnTree();var o=!!t&&this.isSelectedNodeInSubtree(t);this.renderer.render(t);o&&this.selectCurrentNode(r);this._triggerEvent("tree.refresh")}},{key:"_getNodeElementForNode",value:function _getNodeElementForNode(t){return t.isFolder()?new he.FolderElement(t,this):new he.NodeElement(t,this)}},{key:"_getNodeElement",value:function _getNodeElement(t){var r=this.getNode(t);return r?this._getNodeElementForNode(r):null}},{key:"_containsElement",value:function _containsElement(t){var r=this.getNode(jQuery(t));return null!=r&&r.tree===this.tree}},{key:"_getScrollLeft",value:function _getScrollLeft(){return this.scrollHandler.getScrollLeft()}},{key:"init",value:function init(){_get(_getPrototypeOf(JqTreeWidget.prototype),"init",this).call(this);this.element=this.$el;this.isInitialized=false;this.options.rtl=this.getRtlOption();null==this.options.closedIcon&&(this.options.closedIcon=this.getDefaultClosedIcon());this.renderer=new ne.default(this);this.dataLoader=new oe.default(this);this.saveStateHandler=new le.default(this);this.selectNodeHandler=new ue.default(this);this.dndHandler=new re.DragAndDropHandler(this);this.scrollHandler=new se.default(this);this.keyHandler=new ie.default(this);this.initData();this.element.on("click",this.handleClick);this.element.on("dblclick",this.handleDblclick);this.options.useContextMenu&&this.element.on("contextmenu",this.handleContextmenu)}},{key:"deinit",value:function deinit(){this.element.empty();this.element.off();this.keyHandler.deinit();this.tree=new fe.Node({},true);_get(_getPrototypeOf(JqTreeWidget.prototype),"deinit",this).call(this)}},{key:"mouseCapture",value:function mouseCapture(t){return!!this.options.dragAndDrop&&this.dndHandler.mouseCapture(t)}},{key:"mouseStart",value:function mouseStart(t){return!!this.options.dragAndDrop&&this.dndHandler.mouseStart(t)}},{key:"mouseDrag",value:function mouseDrag(t){if(this.options.dragAndDrop){var r=this.dndHandler.mouseDrag(t);this.scrollHandler.checkScrolling();return r}return false}},{key:"mouseStop",value:function mouseStop(t){return!!this.options.dragAndDrop&&this.dndHandler.mouseStop(t)}},{key:"getMouseDelay",value:function getMouseDelay(){var t;return null!==(t=this.options.startDndDelay)&&void 0!==t?t:0}},{key:"initData",value:function initData(){if(this.options.data)this.doLoadData(this.options.data,null);else{var t=this.getDataUrlInfo(null);t?this.doLoadDataFromUrl(null,null,null):this.doLoadData([],null)}}},{key:"getDataUrlInfo",value:function getDataUrlInfo(t){var r=this;var o=this.options.dataUrl||this.element.data("url");var i=function getUrlFromString(t){var r={url:t};a(r);return r};var a=function setUrlInfoData(o){if(null!==t&&void 0!==t&&t.id){var i={node:t.id};o.data=i}else{var a=r.getNodeIdToBeSelected();if(a){var l={selected_node:a};o.data=l}}};if("function"===typeof o)return o(t);if("string"===typeof o)return i(o);if(o&&"object"===_typeof(o)){a(o);return o}return null}},{key:"getNodeIdToBeSelected",value:function getNodeIdToBeSelected(){return this.options.saveState?this.saveStateHandler.getNodeIdToBeSelected():null}},{key:"initTree",value:function initTree(t){var r=this;var o=function doInit(){if(!r.isInitialized){r.isInitialized=true;r._triggerEvent("tree.init")}};if(this.options.nodeClass){this.tree=new this.options.nodeClass(null,true,this.options.nodeClass);this.selectNodeHandler.clear();this.tree.loadFromData(t);var i=this.setInitialState();this._refreshElements(null);i?this.setInitialStateOnDemand(o):o()}}},{key:"setInitialState",value:function setInitialState(){var t=this;var r=function restoreState(){if(t.options.saveState){var r=t.saveStateHandler.getStateFromStorage();if(r){var o=t.saveStateHandler.setInitialState(r);return[true,o]}return[false,false]}return[false,false]};var o=function autoOpenNodes(){if(false===t.options.autoOpen)return false;var r=t.getAutoOpenMaxLevel();var o=false;t.tree.iterate((function(t,i){if(t.load_on_demand){o=true;return false}if(t.hasChildren()){t.is_open=true;return i!==r}return false}));return o};var i=r(),a=_slicedToArray(i,2),l=a[0],u=a[1];l||(u=o());return u}},{key:"setInitialStateOnDemand",value:function setInitialStateOnDemand(t){var r=this;var o=function restoreState(){if(r.options.saveState){var o=r.saveStateHandler.getStateFromStorage();if(o){r.saveStateHandler.setInitialStateOnDemand(o,t);return true}return false}return false};var i=function autoOpenNodes(){var o=r.getAutoOpenMaxLevel();var i=0;var a=function loadAndOpenNode(t){i+=1;r._openNode(t,false,(function(){i-=1;l()}))};var l=function openNodes(){r.tree.iterate((function(t,i){if(t.load_on_demand){t.is_loading||a(t);return false}r._openNode(t,false,null);return i!==o}));0===i&&t()};l()};o()||i()}},{key:"getAutoOpenMaxLevel",value:function getAutoOpenMaxLevel(){return true===this.options.autoOpen?-1:"number"===typeof this.options.autoOpen?this.options.autoOpen:"string"===typeof this.options.autoOpen?parseInt(this.options.autoOpen,10):0}},{key:"getClickTarget",value:function getClickTarget(t){var r=jQuery(t);var o=r.closest(".jqtree-toggler");if(o.length){var i=this.getNode(o);if(i)return{type:"button",node:i}}else{var a=r.closest(".jqtree-element");if(a.length){var l=this.getNode(a);if(l)return{type:"label",node:l}}}return null}},{key:"getNode",value:function getNode(t){var r=t.closest("li.jqtree_common");return 0===r.length?null:r.data("node")}},{key:"saveState",value:function saveState(){this.options.saveState&&this.saveStateHandler.saveState()}},{key:"selectCurrentNode",value:function selectCurrentNode(t){var r=this.getSelectedNode();if(r){var o=this._getNodeElementForNode(r);o&&o.select(t)}}},{key:"deselectCurrentNode",value:function deselectCurrentNode(){var t=this.getSelectedNode();t&&this.removeFromSelection(t)}},{key:"getDefaultClosedIcon",value:function getDefaultClosedIcon(){return this.options.rtl?"&#x25c0;":"&#x25ba;"}},{key:"getRtlOption",value:function getRtlOption(){if(null!=this.options.rtl)return this.options.rtl;var t=this.element.data("rtl");return null!==t&&false!==t&&void 0!==t}},{key:"doSelectNode",value:function doSelectNode(t,r){var o=this;var i=function saveState(){o.options.saveState&&o.saveStateHandler.saveState()};if(t){var a={mustSetFocus:true,mustToggle:true};var l=_objectSpread(_objectSpread({},a),r||{});var u=function canSelect(){return o.options.onCanSelectNode?true===o.options.selectable&&o.options.onCanSelectNode(t):true===o.options.selectable};var d=function openParents(){var r=t.parent;r&&r.parent&&!r.is_open&&o.openNode(r,false)};if(u()){if(this.selectNodeHandler.isNodeSelected(t)){if(l.mustToggle){this.deselectCurrentNode();this._triggerEvent("tree.select",{node:null,previous_node:t})}}else{var c=this.getSelectedNode()||null;this.deselectCurrentNode();this.addToSelection(t,l.mustSetFocus);this._triggerEvent("tree.select",{node:t,deselected_node:c});d()}i()}}else{this.deselectCurrentNode();i()}}},{key:"doLoadData",value:function doLoadData(t,r){if(t){if(r){this.deselectNodes(r);this.loadSubtree(t,r)}else this.initTree(t);this.isDragging()&&this.dndHandler.refresh()}this._triggerEvent("tree.load_data",{tree_data:t,parent_node:r})}},{key:"deselectNodes",value:function deselectNodes(t){var r=this.selectNodeHandler.getSelectedNodesUnder(t);var o,i=_createForOfIteratorHelper(r);try{for(i.s();!(o=i.n()).done;){var a=o.value;this.selectNodeHandler.removeFromSelection(a)}}catch(t){i.e(t)}finally{i.f()}}},{key:"loadSubtree",value:function loadSubtree(t,r){r.loadFromData(t);r.load_on_demand=false;r.is_loading=false;this._refreshElements(r)}},{key:"doLoadDataFromUrl",value:function doLoadDataFromUrl(t,r,o){var i=t||this.getDataUrlInfo(r);this.dataLoader.loadFromUrl(i,r,o)}},{key:"loadFolderOnDemand",value:function loadFolderOnDemand(t){var r=this;var o=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];var i=arguments.length>2?arguments[2]:void 0;t.is_loading=true;this.doLoadDataFromUrl(null,t,(function(){r._openNode(t,o,i)}))}}]);return JqTreeWidget}(ae.default);ee.JqTreeWidget=ye;_defineProperty(ye,"defaults",{animationSpeed:"fast",autoEscape:true,autoOpen:false,buttonLeft:true,closedIcon:void 0,data:void 0,dataFilter:void 0,dataUrl:void 0,dragAndDrop:false,keyboardSupport:true,nodeClass:fe.Node,onCanMove:void 0,onCanMoveTo:void 0,onCanSelectNode:void 0,onCreateLi:void 0,onDragMove:void 0,onDragStop:void 0,onGetStateFromStorage:void 0,onIsMoveHandle:void 0,onLoadFailed:void 0,onLoading:void 0,onSetStateFromStorage:void 0,openedIcon:"&#x25bc;",openFolderDelay:500,rtl:void 0,saveState:false,selectable:true,showEmptyFolder:false,slide:true,startDndDelay:300,tabIndex:0,useContextMenu:true});de.default.register(ye,"tree");const me=ee.__esModule;const ge=ee.JqTreeWidget;export{ge as JqTreeWidget,me as __esModule,ee as default};

