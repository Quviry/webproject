<%= form_with(model: episode, url: "#", html: {method: :post}, class: "dropzone", data: {controller: 'new-episode'}) do |form| %>
  <% if episode.errors.any? %>
    <div class="card m-2" style="color: red">
      <ul>
        <% episode.errors.each do |error| %>
          <li><%= error.message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <%= content_tag :div, class: "form-group", data: {controller: "char-counter", "char-counter-limit-value": 100 } do %>
    <%= content_tag :h3, "Title" %>
    <%= form.text_field :title, class: "form-control", placeholder: "Enter Title", data: {action: "char-counter#update" } %>
    <%= content_tag :div, class: "d-flex flex-direction-row justify-content-end" do %>
      <%= tag.span class: "desc__counter" do %>
        <%= tag.span "0", "data-char-counter-target": "counter" %>
        <%= tag.span "/0", "data-char-counter-target": "total"  %>
      <% end %>
    <% end %>
  <% end %>

  <div class="form-group">
    <h3>Sheduled date</h3>
    <div class="input-group mb-3">
        <%= form.datetime_field :schedule_date, class: "form-control", "aria-describedby": "basic-addon3", "data-provide": "datepicker", data: {"new-episode-target": "datetime"} %>
    </div>
  </div>

    <div class="form-group">
        <% if episode.type == "NovelEpisode" %>
            <h3>Type your story</h3>
            <%= form.rich_text_area :story %>
        <% elsif episode.type == "ComicEpisode" %>
            <h3>Load pages</h3>
            <%= form.file_field :pages, multiple: true, direct_upload: true, class: "form-control" %>
        <% end %>
    </div>


  <div class="form-group" data-controller="image-loader">
    <h3>Thumbnail</h3>
    <%= image_tag episode.thumbnail.attached? ?  episode.thumbnail : "", style: "max-height: 300px; max-width: 200px;", class:"my-2"  %>
    <%= form.file_field :thumbnail, class: "form-control", "data-action": "change->image-loader#update" %>
  </div>

  <div class="form-group">
    <h3>Mature content?</h3>
    <div class="form-check form-switch"><%= form.check_box :nsfw, class: "form-check-input" %></div>
  </div>

  <div class="form-group">
    <h3>Enable comments?</h3>
    <div class="form-check form-switch"><%= form.check_box :comments_enabled, class: "form-check-input" %></div>
  </div>

  <div>
    <%= form.submit class: "btn btn-primary my-3" %>
  </div>

<% end %>
